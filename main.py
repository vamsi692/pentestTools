import os
import webbrowser
from forcedBrowsing import *

class penTools:
    def __init__(self, snowID, URL, URLlist_path, wordlist_path,browser_path):
        self.wordlist_path = wordlist_path
        self.browser_path = browser_path
        self.URLlist_path = URLlist_path
        self.snowID = snowID
        self.URL = URL

    def basics(self):
        self.browser_path = input("please specify the browser path, usually for linux it is /usr/lib/firefox-esr/firefox-bin :")

    def nmap(self):
        URL1=self.URL.split("://")[1]
        cmd = "sudo nmap -oG "+self.snowID+"_nmap.txt -sS " + URL1
        os.system(cmd)

    def dirb(self):
        cmd = "sudo dirb "+ self.URL + " " + self.wordlist_path + "-o" + self.snowID + "_dirb.txt"
        os.system(cmd)

    def forceBrowse(self):
        forcedBrowsing(self.URLlist_path, self.browser_path)

snowID=""
URL=""
URLlist=None
wordlist=""
snowID=input("please enter snowID* : ")
URL = input("please enter the URL of the application* : ")
URLlist_path = input("please enter the location of the list of URLs (you can leave this field blank if you want a default scan) : ")
wordlist_path = input("please enter the location of the list of wordlist (you can leave this field blank if you want a default scan) : ")
pt=penTools(snowID, URL, URLlist_path, wordlist_path)
# print(pt.snowID + "," + pt.URL + "," + pt.URLlist + "," + pt.wordlist)
# print(URL.split("://")[1])
pt.basics()
pt.nmap()
pt.dirb()
pt.forceBrowse()
